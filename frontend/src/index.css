@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    html {
        @apply bg-[#0a0a0a] min-h-screen selection:bg-emerald-500/30;
        scrollbar-gutter: stable;
        /* Crucial: Prevents the screen from shifting left when scrollbar appears */
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
    }

    body {
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
        padding-left: env(safe-area-inset-left);
        padding-right: env(safe-area-inset-right);
    }
}

@layer components {
    .glass-card {
        background: rgba(18, 18, 18, 0.7);
        -webkit-backdrop-filter: blur(12px);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .glass-input {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        @apply transition-all duration-200 focus:border-emerald-500/50 focus:ring-0 outline-none rounded-lg py-3 px-10 w-full text-sm text-gray-200;
    }

    .login-btn {
        background: linear-gradient(90deg, #10b981 0%, #059669 100%);
        width: 100%;
        padding: 0.75rem;
        border-radius: 0.5rem;
        font-weight: 600;
        color: white;
        transition: all 0.3s;
        transform-origin: center;
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
    }

    .login-btn:hover {
        box-shadow: 0 0 30px rgba(16, 185, 129, 0.5);
    }

    .login-btn:active {
        transform: scale(0.98);
    }

    .signup-btn {
        background: linear-gradient(90deg, #10b981 0%, #059669 100%);
        width: 100%;
        padding: 0.75rem;
        border-radius: 0.5rem;
        font-weight: 600;
        color: white;
        transition: all 0.3s;
        transform-origin: center;
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
    }

    .signup-btn:hover {
        box-shadow: 0 0 30px rgba(16, 185, 129, 0.5);
    }

    .signup-btn:active {
        transform: scale(0.98);
    }

    .social-btn {
        @apply flex items-center justify-center gap-2 bg-white/5 border border-white/10 rounded-lg p-2 transition-all hover:bg-white/10 grayscale hover:grayscale-0;
    }

    /* Instagram Specific Styles */
    .story-ring {
        background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
        padding: 2.5px;
        @apply rounded-full;
    }

    .sidebar-link {
        @apply flex items-center gap-4 px-6 py-4 text-gray-500 hover:text-emerald-400 transition-all border-l-2 border-transparent hover:border-emerald-500 hover:bg-emerald-500/5 cursor-pointer;
    }

    .sidebar-link.active {
        @apply text-emerald-400 border-emerald-500 bg-emerald-500/5;
    }

    .post-card {
        @apply bg-[#111] border border-white/5 rounded-3xl overflow-hidden mb-8;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        transform-style: preserve-3d;
    }

    .post-media-fix {
        position: absolute !important;
        top: 50% !important;
        left: 50% !important;
        width: 105% !important;
        height: 175% !important;
        margin: 0 !important;

        /* Forced GPU Acceleration & Butter Smoothness */
        transform: translate3d(-50%, -50%, 0.1px) rotate(0.01deg);
        backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
        perspective: 1000px;
        transform-style: preserve-3d;

        /* Performance Throttling: Only hint changes when we definitely need them */
        will-change: transform;

        /* Higher Fidelity Rendering with Performance balance */
        image-rendering: -webkit-optimize-contrast;
        -webkit-font-smoothing: antialiased;

        /* Ultra-Premium Butter Glide */
        transition: transform 1.8s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.8s ease-in-out;
    }

    /* Trigger animation ONLY when post is in view & active */
    .post-media-fix.active-cinematic {
        animation: cinematic-breath-pan 12s cubic-bezier(0.4, 0, 0.2, 1) infinite !important;
    }

    @keyframes cinematic-breath-pan {
        0% {
            transform: scale(1) translate3d(-50%, -50%, 0) rotate(0.01deg);
        }

        /* Initial Zoom In/Out */
        10% {
            transform: scale(1.1) translate3d(-50%, -50%, 0) rotate(0.01deg);
        }

        /* Pan Up (Show Bottom) - Moves Center UP to -65% */
        30% {
            transform: scale(1.05) translate3d(-50%, -65%, 0) rotate(0.01deg);
        }

        /* Return to Center (Slightly Faster) + Zoom In */
        45% {
            transform: scale(1.15) translate3d(-50%, -50%, 0) rotate(0.01deg);
        }

        /* Zoom Out */
        55% {
            transform: scale(1.05) translate3d(-50%, -50%, 0) rotate(0.01deg);
        }

        /* Pan Down (Show Top) - Moves Center DOWN to -35% */
        75% {
            transform: scale(1.05) translate3d(-50%, -35%, 0) rotate(0.01deg);
        }

        /* Return to Center (Slightly Faster) + Zoom In */
        90% {
            transform: scale(1.1) translate3d(-50%, -50%, 0) rotate(0.01deg);
        }

        100% {
            transform: scale(1) translate3d(-50%, -50%, 0) rotate(0.01deg);
        }
    }

    /* Sub-pixel Clipping Fix for the container */
    .post-media-container {
        position: relative;
        overflow: hidden;
        /* This forces a new stacking context and clean clipping */
        isolation: isolate;
        /* create a stacking context without mask to avoid artifacts */
        z-index: 1;
        transform: translateZ(0);
        backface-visibility: hidden;
        will-change: transform, opacity;
    }

    .stats-item {
        @apply flex flex-col items-center justify-center;
    }

    .stats-value {
        @apply text-lg font-bold text-white;
    }

    .stats-label {
        @apply text-[9px] uppercase tracking-widest text-gray-500;
    }

    .hide-scrollbar::-webkit-scrollbar {
        display: none;
    }

    .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
}

/* Legendary Global Scrollbar - Fluid Stealth System */
::-webkit-scrollbar {
    width: 4px;
    /* Hair-thin for negligible feeling */
    height: 4px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: transparent;
    border-radius: 10px;
    transition: background 0.4s ease;
}

/* Only show thumb when scrolling is detected on the root element */
.is-scrolling::-webkit-scrollbar-thumb,
::-webkit-scrollbar-thumb:hover {
    background: rgba(16, 185, 129, 0.6);
    /* Vibrant Emerald Glow */
    border: 1px solid rgba(255, 255, 255, 0.05);
}

/* Firefox Support */
* {
    scrollbar-width: thin;
    scrollbar-color: transparent transparent;
}

.is-scrolling,
*:hover {
    scrollbar-color: rgba(16, 185, 129, 0.6) transparent;
}

/* Custom animations */
@keyframes float {
    0% {
        transform: translateY(0px) rotate(0deg);
    }

    50% {
        transform: translateY(-20px) rotate(2deg);
    }

    100% {
        transform: translateY(0px) rotate(0deg);
    }
}

.floating {
    animation: float 6s ease-in-out infinite;
}

/* Standardized Neural Skeleton Shimmer */
.animate-skeleton-shimmer {
    background-size: 200% 100%;
    animation: skeleton-shimmer 1.8s infinite linear;
}

@keyframes skeleton-shimmer {
    0% {
        background-position: 200% 0;
    }

    100% {
        background-position: -200% 0;
    }
}

/* Mobile-Specific Overrides for APK */
@media (max-width: 640px) {
    .post-card {
        border-radius: 0;
        border-left: none;
        border-right: none;
        margin-bottom: 2rem;
    }

    .post-media-container {
        border-radius: 0;
    }

    .post-header {
        padding: 1rem !important;
    }

    .post-actions {
        padding: 1rem !important;
    }
}